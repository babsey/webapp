<html>
    <head>
        <title>Scatterplot</title>
        <link rel="stylesheet" href="/media/css/default.css"></link>
        <link rel="stylesheet" href="/media/css/result.css"></link>

        <script type="text/javascript" src="/media/js/jquery-1.6.2.min.js"></script>
        <script type="text/javascript" src="/media/js/protovis.min.js"></script>
        <script type="text/javascript" src="/media/js/jquery.spinedit.js"></script>
        <script type="text/javascript" src="/media/js/protovis.spike_detector.js"></script>

    </head>

    <body>
        <div id="center">
            <div id="fig">
                <span id="chart"></span>

                <script type="text/javascript+protovis">
   
                    /* Data of Spikes. */ 
                    var senders = {{ senders|safe }},
                    times = {{ times|safe }},
                    simTime = {{ simTime|safe }},
                    neuronScale = {{ neuronScale|safe }},
                    neurons = {{ neurons|safe }},
                    fig = {{ fig|safe }};

                    var nr_spikes = 1,
                    kw = 100;

                    /* Size of panels. */
                    var w = fig.w,
                    h1 = neuronScale.length * 10,
                    h2 = fig.h2,
                    h = h1 + 30 + h2;

                    $( "#fig" ).css("width", fig.width);

                    /* Scales of PSTH panel */
                    var xScale = pv.Scale.linear(0, simTime).range(0, w),
                    yScale = pv.Scale.linear(1,neuronScale.length).range(0, h1);

                    var psth = psth_calc();                    
                    var psth_yScale = pv.Scale.linear(0, pv.max(psth, function(d) d+1)).range(0, h2);

                    vis = prep_vis();
                    vis.render()

                    $( "input#kernel_width" ).bind("change mouseup mouseout keyup", function () { 
                            kw = parseFloat($(this).val());
                            vis.render();
                    });
              

                    $(function() {
                            $( "input#kernel_width" ).SpinEdit({'min': 10, 'step': 30}).val(kw);
                    });

                </script>

                <p>
                    <label for "kernel_width"> Kernel width: </label>
                    <input type="text" class="spinedit" id="kernel_width"/> ms
                </p>

            </div>
        </div>
    </body>
</html>
